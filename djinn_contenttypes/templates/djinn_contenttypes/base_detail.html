{% extends "layout-8x4.html" %}

{% load pgcomment_tags i18n djinn_contenttypes auth_tags contentaction_tags %}

{% block body_class %}ct {{ object.ct_name }} view {% if not object.is_published %}unpublished{% endif %}{% endblock %}

{% block left-pane %}

<article>

  {% block header %}
  <header>
    <h1>{% block title %}{% title object %}{% endblock %}</h1>
  </header>

  {% block metainfo %}
  {% with perm=object|edit_permission_id %}
  <div class="meta-info">
  {% with highlight_from=object.highlight_from %}
    <span class="profile-type">{{ object.ct_label }}</span>
    {% if object.is_public %}
      {% ifpermission object request.user perm %}
        {% if object.publish_from %}
          {% trans "Publish from" %}: {{ object.publish_from }},
        {% else %}
          {% trans "Published on" %}: {{ view.created }},
        {% endif %}
      {% else %}
        {% trans "Published on" %}: {{ view.created }},
      {% endifpermission %}
      {% if highlight_from and highlight_from <= highlight_from.now %}
      {% trans "Highlight from" %}: {{ highlight_from }},
      {% endif %}
    {% elif not object.is_published %}
      {% trans "Unpublished" %},
    {% endif %}

    {% ifpermission object request.user perm %}
      {% if object.publish_from and not object.is_public %}
      {% trans "Publish from" %}: {{ object.publish_from }},
      {% endif %}                             
      {% if object.publish_to %}
      {% trans "Published till" %}: {{ object.publish_to }},
      {% endif %}                             
    {% endifpermission %}

    {% if not highlight_from or highlight_from > highlight_from.now %}
    {% trans "Last change" %}: {{ object.changed }},
    {% endif %}
    
    {% if object|implements:"djinn_contenttypes.Commentable" %}
    {% trans "Reactions" %}: {% comment_count_for user object %}
    {% endif %}

  {% endwith %}
  </div>
  {% endwith %}
  {% endblock metainfo %}
  {% endblock header %}

  {% block content %}
  {% endblock content %}

  {% if object|implements:"djinn_contenttypes.Commentable" %}
  {% comments_for object %}
  {% endif %}
</article>
{% endblock left-pane %}


{% block right-pane %}
<div class="action-bar">
  {% block extra_actions %}{% endblock extra_actions %}
  {% with perm=object|edit_permission_id %}
  {% ifpermission object request.user perm %}
  {% edit_action object %}
  {% endifpermission %}
  {% endwith %}
</div>

<section id="ownership">
  {% owner object 'False' %}
</section>

{% if object.parentusergroup %}

<section id="content-for-group">

  <h3>Geplaatst in de groep</h3>

  {% with group=object.parentusergroup.profile %}
  <div class="groupprofilesummary">

    <figure>
      <a class="groupprofile" href="{{ group.get_absolute_url }}">
        <img src="{{ group.avatar_url }}"/>
      </a>
    </figure>

    <div class="text">
      <a class="groupprofile"
         href="{{ group.get_absolute_url }}">{{ group }}</a>
    </div>

  </div>
  {% endwith %}

</section>

{% endif %}

{% block right-pane-extra %}
{% endblock %}

{% endblock right-pane %}
